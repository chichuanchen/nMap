---
title: "trial_number_stats"
author: "CC"
date: "2023-04-26"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Stats on ERP trial number

setup
```{r, echo=FALSE}

library("tidyverse")
library("readxl")
library("rstatix")

rm(list=ls())

load("./../../data/ERP/tidied/erp_individual_trial.RData")

```

## Count number of trials for each subject, each component, and each condition
```{r, echo=FALSE}
# Trial # stats -----
n_trial_subj <- data_erp_all_indi_trial %>%
  group_by(subj_num, time_point, component, cond) %>%
  summarise(n_trial_individual = n()) %>%
  ungroup() %>%
  mutate(order =
           case_when(
             cond %in% c(1, 3, 5) ~ "increase",
             cond %in% c(2, 4, 6) ~ "decrease")) %>%
  mutate(order = factor(order),
         cond = factor(cond))
```
## Component doesnt seem to matter - numbers are the same across components. Remove redundant info. Add unique ID column.
```{r}
n_trial_subj <- n_trial_subj %>% 
  distinct_at(vars(-component)) %>% 
  unite("uID", subj_num, time_point, sep = "_", remove = F, na.rm = FALSE) %>%
  mutate(uID = factor(uID))
```


## Calculate the mean, sd, and range for the number of trials per subject for each of the 6 conditions
```{r, echo=FALSE}
n_trial_cond <- n_trial_subj %>%
  group_by(cond) %>%
  summarise(mean_n_trial_cond = mean(n_trial_individual),
            sd_n_trial_cond = sd(n_trial_individual),
            range_min = min(n_trial_individual),
            range_max = max(n_trial_individual)) %>%
  ungroup() 
```

```{r}
n_trial_cond
```

## Inferential Stats
### Are there differences in the number of trials across the six conditions? - No
```{r}
cond_dif <- lm(n_trial_individual ~ cond, data = n_trial_subj)
anova(cond_dif)

aov.cond <- anova_test(data = n_trial_subj, dv = n_trial_individual, wid = uID, within = cond)
get_anova_table(aov.cond)
```

### Are there differences in the number of increasing vs. decreasing trials? - No
```{r}
# order_dif <- lm(n_trial_individual ~ order, data = n_trial_subj)
# anova(order_dif)

# aov.cond<-aov(n_trial_individual ~ order + Error(uID), n_trial_subj)

aov.cond <- n_trial_subj %>% 
  anova_test(dv=n_trial_individual, within = order, wid = uID)
get_anova_table(aov.cond)
```

